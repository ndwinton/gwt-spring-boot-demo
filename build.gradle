/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven'
    id "de.esoco.gwt" version "1.0.7"
    id 'org.springframework.boot' version '2.1.3.RELEASE'
}

apply plugin: 'io.spring.dependency-management'

def gwtVersionNo = '2.8.2'

repositories {
    mavenCentral()
}

dependencies {
    runtime "com.google.gwt:gwt-servlet:$gwtVersionNo"
    testCompile 'junit:junit:4.11'
    compile "com.google.gwt:gwt-user:$gwtVersionNo"
    compile "com.google.gwt:gwt-dev:$gwtVersionNo"

    compile("org.springframework.boot:spring-boot-starter-web") {
        exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
    }
    compile("org.springframework.boot:spring-boot-starter-jetty")

//    implementation "javax.ws.rs:javax.ws.rs-api:2.0.1"
//    compileOnly "org.fusesource.restygwt:restygwt:2.2.0"
//    implementation "com.fasterxml.jackson.jaxrs:jackson-jaxrs-json-provider:2.8.9"
}

group = 'io.pivotal.demo'
version = '1.0-SNAPSHOT'
description = 'io.pivotal.demo.GwtDemo'
sourceCompatibility = '1.8'

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

gwt {
    gwtVersion = gwtVersionNo

    //module("org.example.gwt.StockWatcher2", "de.richsource.gradle.plugins.gwt.example.Example")
    module("io.pivotal.demo.GwtDemo")
    // other configuration options
}

task copyGWTCode(dependsOn: ["gwtCompile"], type: Copy) {
    from file("${buildDir}/gwt/out")
    into file("${buildDir}/resources/main/static")
}

bootJar {
    dependsOn copyGWTCode
    doLast {
        mkdir "${buildDir}/target"
        setDestinationDir(file("${buildDir}/target"))
        copy()
    }
}